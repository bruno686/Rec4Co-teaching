arguments: Namespace(alpha=0.25, batch_size=1024, dataset='adressa', dropout=0.0, epochs=10, eval_freq=100, factor_num=32, gpu='7', lr=0.001, model='NeuMF-end', num_layers=3, num_ng=1, out=True, top_k=[3, 20]) 
config model NeuMF-end
config data path ../data/adressa/
config model path ./models/adressa/
user, item num
212231 6596
data loaded! user_num:212231, item_num:6596 train_data_len:419491 test_user_num:10380
/storage/wjwang/anaconda3/lib/python3.7/site-packages/torch/nn/_reduction.py:43: UserWarning: size_average and reduce args will be deprecated, please use reduction='none' instead.
  warnings.warn(warning.format(ret))
epoch: 0, iter: 100, loss:0.047528110444545746
################### EVAL ######################
Eval loss:14.720292091369629
epoch: 0, iter: 200, loss:0.0525546558201313
################### EVAL ######################
Eval loss:15.600818634033203
epoch: 0, iter: 300, loss:0.049416787922382355
################### EVAL ######################
Eval loss:16.103363037109375
epoch: 0, iter: 400, loss:0.06787052005529404
################### EVAL ######################
Eval loss:17.339630126953125
epoch: 0, iter: 500, loss:0.059229910373687744
################### EVAL ######################
Eval loss:15.837386131286621
epoch: 0, iter: 600, loss:0.057290419936180115
################### EVAL ######################
Eval loss:16.859804153442383
epoch: 0, iter: 700, loss:0.03604036569595337
################### EVAL ######################
Eval loss:15.30302619934082
epoch: 0, iter: 800, loss:0.053058773279190063
################### EVAL ######################
Eval loss:16.450925827026367
epoch: 1, iter: 900, loss:0.042907968163490295
################### EVAL ######################
Eval loss:15.419076919555664
epoch: 1, iter: 1000, loss:0.03789412975311279
################### EVAL ######################
Eval loss:15.48940658569336
epoch: 1, iter: 1100, loss:0.04540581628680229
################### EVAL ######################
Eval loss:16.968528747558594
epoch: 1, iter: 1200, loss:0.035552237182855606
################### EVAL ######################
Eval loss:16.43755531311035
epoch: 1, iter: 1300, loss:0.040926605463027954
################### EVAL ######################
Eval loss:17.51532745361328
epoch: 1, iter: 1400, loss:0.04148687794804573
################### EVAL ######################
Eval loss:16.19350242614746
epoch: 1, iter: 1500, loss:0.04545851796865463
################### EVAL ######################
Eval loss:17.846885681152344
epoch: 1, iter: 1600, loss:0.04279278218746185
################### EVAL ######################
Eval loss:18.206762313842773
epoch: 2, iter: 1700, loss:0.031016487628221512
################### EVAL ######################
Eval loss:18.811477661132812
epoch: 2, iter: 1800, loss:0.030955012887716293
################### EVAL ######################
Eval loss:16.546485900878906
epoch: 2, iter: 1900, loss:0.0393025279045105
################### EVAL ######################
Eval loss:22.732851028442383
epoch: 2, iter: 2000, loss:0.034682758152484894
################### EVAL ######################
Eval loss:21.474227905273438
epoch: 2, iter: 2100, loss:0.03392011672258377
################### EVAL ######################
Eval loss:19.600278854370117
epoch: 2, iter: 2200, loss:0.037617139518260956
################### EVAL ######################
Eval loss:19.389211654663086
epoch: 2, iter: 2300, loss:0.036303356289863586
################### EVAL ######################
Eval loss:18.37738800048828
epoch: 2, iter: 2400, loss:0.032971616834402084
################### EVAL ######################
Eval loss:22.48491668701172
epoch: 3, iter: 2500, loss:0.023898305371403694
################### EVAL ######################
Eval loss:27.26317024230957
epoch: 3, iter: 2600, loss:0.02426780015230179
################### EVAL ######################
Eval loss:22.789691925048828
epoch: 3, iter: 2700, loss:0.02326393499970436
################### EVAL ######################
Eval loss:26.487010955810547
epoch: 3, iter: 2800, loss:0.026024095714092255
################### EVAL ######################
Eval loss:29.6236515045166
epoch: 3, iter: 2900, loss:0.019947849214076996
################### EVAL ######################
Eval loss:31.714614868164062
epoch: 3, iter: 3000, loss:0.02755792625248432
################### EVAL ######################
Eval loss:33.586280822753906
epoch: 3, iter: 3100, loss:0.031227201223373413
################### EVAL ######################
Eval loss:32.823211669921875
epoch: 3, iter: 3200, loss:0.02866630256175995
################### EVAL ######################
Eval loss:31.390869140625
epoch: 4, iter: 3300, loss:0.014665910042822361
################### EVAL ######################
Eval loss:32.81587600708008
epoch: 4, iter: 3400, loss:0.012806463986635208
################### EVAL ######################
Eval loss:33.210113525390625
epoch: 4, iter: 3500, loss:0.018187247216701508
################### EVAL ######################
Eval loss:33.868629455566406
epoch: 4, iter: 3600, loss:0.01482919231057167
################### EVAL ######################
Eval loss:32.134925842285156
epoch: 4, iter: 3700, loss:0.013701003976166248
################### EVAL ######################
Eval loss:34.128543853759766
epoch: 4, iter: 3800, loss:0.02092711441218853
################### EVAL ######################
Eval loss:37.368228912353516
epoch: 4, iter: 3900, loss:0.011240851134061813
################### EVAL ######################
Eval loss:35.053443908691406
epoch: 4, iter: 4000, loss:0.013474179431796074
################### EVAL ######################
Eval loss:36.263893127441406
epoch: 5, iter: 4100, loss:0.012217991054058075
################### EVAL ######################
Eval loss:35.03535079956055
epoch: 5, iter: 4200, loss:0.008516637608408928
################### EVAL ######################
Eval loss:34.78532791137695
epoch: 5, iter: 4300, loss:0.011689145117998123
################### EVAL ######################
Eval loss:34.2601318359375
epoch: 5, iter: 4400, loss:0.009597908705472946
################### EVAL ######################
Eval loss:33.642887115478516
epoch: 5, iter: 4500, loss:0.014128163456916809
################### EVAL ######################
Eval loss:34.756317138671875
epoch: 5, iter: 4600, loss:0.00897911936044693
################### EVAL ######################
Eval loss:33.448673248291016
epoch: 5, iter: 4700, loss:0.004921785555779934
################### EVAL ######################
Eval loss:33.17097854614258
epoch: 5, iter: 4800, loss:0.013092313893139362
################### EVAL ######################
Eval loss:35.96105194091797
epoch: 5, iter: 4900, loss:0.0055029671639204025
################### EVAL ######################
Eval loss:36.187355041503906
epoch: 6, iter: 5000, loss:0.009006486274302006
################### EVAL ######################
Eval loss:33.506866455078125
epoch: 6, iter: 5100, loss:0.006025920622050762
################### EVAL ######################
Eval loss:33.10832595825195
epoch: 6, iter: 5200, loss:0.007701504975557327
################### EVAL ######################
Eval loss:33.48988342285156
epoch: 6, iter: 5300, loss:0.01008252240717411
################### EVAL ######################
Eval loss:33.40254592895508
epoch: 6, iter: 5400, loss:0.004955490119755268
################### EVAL ######################
Eval loss:34.6065788269043
epoch: 6, iter: 5500, loss:0.005830402486026287
################### EVAL ######################
Eval loss:34.1236457824707
epoch: 6, iter: 5600, loss:0.00592047581449151
################### EVAL ######################
Eval loss:34.112579345703125
epoch: 6, iter: 5700, loss:0.008825844153761864
################### EVAL ######################
Eval loss:34.55930709838867
epoch: 7, iter: 5800, loss:0.006288924254477024
################### EVAL ######################
Eval loss:31.75725555419922
epoch: 7, iter: 5900, loss:0.003497628029435873
################### EVAL ######################
Eval loss:33.261268615722656
epoch: 7, iter: 6000, loss:0.0060997623950243
################### EVAL ######################
Eval loss:33.23037338256836
epoch: 7, iter: 6100, loss:0.004321204498410225
################### EVAL ######################
Eval loss:32.751216888427734
epoch: 7, iter: 6200, loss:0.004021718632429838
################### EVAL ######################
Eval loss:32.611419677734375
epoch: 7, iter: 6300, loss:0.006903042085468769
################### EVAL ######################
Eval loss:33.13571548461914
epoch: 7, iter: 6400, loss:0.00558281596750021
################### EVAL ######################
Eval loss:32.347129821777344
epoch: 7, iter: 6500, loss:0.006042532157152891
################### EVAL ######################
Eval loss:33.20009994506836
epoch: 8, iter: 6600, loss:0.004097446799278259
################### EVAL ######################
Eval loss:32.04213333129883
epoch: 8, iter: 6700, loss:0.00573936989530921
################### EVAL ######################
Eval loss:31.256452560424805
epoch: 8, iter: 6800, loss:0.0015105016063898802
################### EVAL ######################
Eval loss:31.96975326538086
epoch: 8, iter: 6900, loss:0.004177852533757687
################### EVAL ######################
Eval loss:33.196632385253906
epoch: 8, iter: 7000, loss:0.0030003516003489494
################### EVAL ######################
Eval loss:32.55464553833008
epoch: 8, iter: 7100, loss:0.0036571542732417583
################### EVAL ######################
Eval loss:32.59333038330078
epoch: 8, iter: 7200, loss:0.004043118562549353
################### EVAL ######################
Eval loss:33.20331954956055
epoch: 8, iter: 7300, loss:0.003855056595057249
################### EVAL ######################
Eval loss:32.982425689697266
epoch: 9, iter: 7400, loss:0.00489490432664752
################### EVAL ######################
Eval loss:31.392000198364258
epoch: 9, iter: 7500, loss:0.004534933716058731
################### EVAL ######################
Eval loss:32.374332427978516
epoch: 9, iter: 7600, loss:0.003745557274669409
################### EVAL ######################
Eval loss:31.143037796020508
epoch: 9, iter: 7700, loss:0.003911797422915697
################### EVAL ######################
Eval loss:33.286643981933594
epoch: 9, iter: 7800, loss:0.004100519698113203
################### EVAL ######################
Eval loss:31.212703704833984
epoch: 9, iter: 7900, loss:0.0032972805202007294
################### EVAL ######################
Eval loss:32.52183532714844
epoch: 9, iter: 8000, loss:0.0024414919316768646
################### EVAL ######################
Eval loss:33.05897903442383
epoch: 9, iter: 8100, loss:0.0035813627764582634
################### EVAL ######################
Eval loss:33.39642333984375
############################## Training End. ##############################
################### TEST ######################
Recall 0.1414-0.3185
NDCG 0.1266-0.1896
